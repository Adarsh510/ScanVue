{"ast":null,"code":"import React,{Component}from\"react\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default class CameraFeed extends Component{constructor(){super(...arguments);this.takePhoto=()=>{const{sendFile}=this.props;const context=this.canvas.getContext(\"2d\");context.drawImage(this.videoPlayer,0,0,680,360);this.canvas.toBlob(sendFile);this.props.closeWindow();};}processDevices(devices){devices.forEach(device=>{console.log(device.label);if(device.kind===\"videoinput\")this.setVideoDevice(device);});}async setVideoDevice(device){var _this$videoPlayer;const{deviceId}=device;const stream=await navigator.mediaDevices.getUserMedia({audio:false,video:{deviceId}});console.log(\"stream\",stream);if(this.videoPlayer&&stream!==null)this.videoPlayer.srcObject=stream;(_this$videoPlayer=this.videoPlayer)===null||_this$videoPlayer===void 0?void 0:_this$videoPlayer.play();}async componentDidMount(){const allDevices=await navigator.mediaDevices.enumerateDevices();console.log(\"allDevices\",allDevices);this.processDevices(allDevices);}async componentWillUnmount(){if(this.videoPlayer&&this.videoPlayer.srcObject)this.videoPlayer.srcObject.getTracks().forEach(function(track){console.log(\"trabck\",track);if(track.readyState===\"live\"&&track.kind===\"video\"){track.stop();}});}render(){return/*#__PURE__*/_jsxs(\"div\",{className:\"c-camera-feed\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"c-camera-feed__viewer\",children:/*#__PURE__*/_jsx(\"video\",{style:{maxWidth:\"100%\"},ref:ref=>{console.log(\"videoref\",ref);if(ref)this.videoPlayer=ref;},width:\"680\",heigh:\"360\"})}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-lg btn-primary\",onClick:this.takePhoto,children:\"Capture Image\"}),/*#__PURE__*/_jsx(\"div\",{className:\"c-camera-feed__stage\",style:{display:\"none\"},children:/*#__PURE__*/_jsx(\"canvas\",{width:\"680\",height:\"360\",ref:ref=>this.canvas=ref})})]});}}","map":{"version":3,"names":["React","Component","jsx","_jsx","jsxs","_jsxs","CameraFeed","constructor","arguments","takePhoto","sendFile","props","context","canvas","getContext","drawImage","videoPlayer","toBlob","closeWindow","processDevices","devices","forEach","device","console","log","label","kind","setVideoDevice","_this$videoPlayer","deviceId","stream","navigator","mediaDevices","getUserMedia","audio","video","srcObject","play","componentDidMount","allDevices","enumerateDevices","componentWillUnmount","getTracks","track","readyState","stop","render","className","children","style","maxWidth","ref","width","heigh","onClick","display","height"],"sources":["D:/PROJECTS/ScanVue/client/src/components/camera.jsx"],"sourcesContent":["import React, { Component } from \"react\";\n\nexport default class CameraFeed extends Component {\n  processDevices(devices) {\n    devices.forEach((device) => {\n      console.log(device.label);\n      if (device.kind === \"videoinput\") this.setVideoDevice(device);\n    });\n  }\n\n  async setVideoDevice(device) {\n    const { deviceId } = device;\n    const stream = await navigator.mediaDevices.getUserMedia({\n      audio: false,\n      video: { deviceId },\n    });\n    console.log(\"stream\", stream);\n    if (this.videoPlayer && stream !== null)\n      this.videoPlayer.srcObject = stream;\n    this.videoPlayer?.play();\n  }\n\n  async componentDidMount() {\n    const allDevices = await navigator.mediaDevices.enumerateDevices();\n    console.log(\"allDevices\", allDevices);\n    this.processDevices(allDevices);\n  }\n  async componentWillUnmount() {\n    if (this.videoPlayer && this.videoPlayer.srcObject)\n      this.videoPlayer.srcObject.getTracks().forEach(function (track) {\n        console.log(\"trabck\", track);\n        if (track.readyState === \"live\" && track.kind === \"video\") {\n          track.stop();\n        }\n      });\n  }\n\n  takePhoto = () => {\n    const { sendFile } = this.props;\n    const context = this.canvas.getContext(\"2d\");\n    context.drawImage(this.videoPlayer, 0, 0, 680, 360);\n    this.canvas.toBlob(sendFile);\n    this.props.closeWindow();\n  };\n\n  render() {\n    return (\n      <div className=\"c-camera-feed\">\n        <div className=\"c-camera-feed__viewer\">\n          <video\n            style={{ maxWidth: \"100%\" }}\n            ref={(ref) => {\n              console.log(\"videoref\", ref);\n              if (ref) this.videoPlayer = ref;\n            }}\n            width=\"680\"\n            heigh=\"360\"\n          />\n        </div>\n        <button className=\"btn btn-lg btn-primary\" onClick={this.takePhoto}>\n          Capture Image\n        </button>\n        <div className=\"c-camera-feed__stage\" style={{ display: \"none\" }}>\n          <canvas width=\"680\" height=\"360\" ref={(ref) => (this.canvas = ref)} />\n        </div>\n      </div>\n    );\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}